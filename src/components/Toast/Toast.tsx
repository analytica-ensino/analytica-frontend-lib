import React from 'react';

const IconSuccess = () => (
  <svg
    data-testid="success-icon"
    width="18"
    height="18"
    viewBox="0 0 18 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M0.75 9C0.75 4.44354 4.44354 0.75 9 0.75C13.5565 0.75 17.25 4.44354 17.25 9C17.25 13.5565 13.5565 17.25 9 17.25C4.44354 17.25 0.75 13.5565 0.75 9ZM9 2.25C5.27196 2.25 2.25 5.27196 2.25 9C2.25 12.728 5.27196 15.75 9 15.75C12.728 15.75 15.75 12.728 15.75 9C15.75 5.27196 12.728 2.25 9 2.25Z"
      fill="#166534"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M11.7803 6.96967C12.0732 7.26256 12.0732 7.73744 11.7803 8.03033L8.78033 11.0303C8.48744 11.3232 8.01256 11.3232 7.71967 11.0303L6.21967 9.53033C5.92678 9.23744 5.92678 8.76256 6.21967 8.46967C6.51256 8.17678 6.98744 8.17678 7.28033 8.46967L8.25 9.43934L10.7197 6.96967C11.0126 6.67678 11.4874 6.67678 11.7803 6.96967Z"
      fill="#166534"
    />
  </svg>
);

const IconWarning = () => (
  <svg
    data-testid="warning-icon"
    width="18"
    height="18"
    viewBox="0 0 18 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M0.75 9C0.75 4.44365 4.44365 0.75 9 0.75C13.5563 0.75 17.25 4.44365 17.25 9C17.25 13.5563 13.5563 17.25 9 17.25C4.44365 17.25 0.75 13.5563 0.75 9ZM9 2.25C5.27208 2.25 2.25 5.27208 2.25 9C2.25 12.7279 5.27208 15.75 9 15.75C12.7279 15.75 15.75 12.7279 15.75 9C15.75 5.27208 12.7279 2.25 9 2.25Z"
      fill="#D76C1F"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M9 5.25C9.41421 5.25 9.75 5.58579 9.75 6V9C9.75 9.41421 9.41421 9.75 9 9.75C8.58579 9.75 8.25 9.41421 8.25 9V6C8.25 5.58579 8.58579 5.25 9 5.25Z"
      fill="#D76C1F"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M8.25 12C8.25 11.5858 8.58579 11.25 9 11.25H9.0075C9.42171 11.25 9.7575 11.5858 9.7575 12C9.7575 12.4142 9.42171 12.75 9.0075 12.75H9C8.58579 12.75 8.25 12.4142 8.25 12Z"
      fill="#D76C1F"
    />
  </svg>
);

const IconInfo = () => (
  <svg
    data-testid="info-icon"
    width="18"
    height="18"
    viewBox="0 0 18 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M0.75 9C0.75 4.44365 4.44365 0.75 9 0.75C13.5563 0.75 17.25 4.44365 17.25 9C17.25 13.5563 13.5563 17.25 9 17.25C4.44365 17.25 0.75 13.5563 0.75 9ZM9 2.25C5.27208 2.25 2.25 5.27208 2.25 9C2.25 12.7279 5.27208 15.75 9 15.75C12.7279 15.75 15.75 12.7279 15.75 9C15.75 5.27208 12.7279 2.25 9 2.25Z"
      fill="#0B8DCD"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M9 8.25C9.41421 8.25 9.75 8.58579 9.75 9V12C9.75 12.4142 9.41421 12.75 9 12.75C8.58579 12.75 8.25 12.4142 8.25 12V9C8.25 8.58579 8.58579 8.25 9 8.25Z"
      fill="#0B8DCD"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M8.25 6C8.25 5.58579 8.58579 5.25 9 5.25H9.0075C9.42171 5.25 9.7575 5.58579 9.7575 6C9.7575 6.41421 9.42171 6.75 9.0075 6.75H9C8.58579 6.75 8.25 6.41421 8.25 6Z"
      fill="#0B8DCD"
    />
  </svg>
);

const IconClose = () => (
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M12.4711 3.52876C12.7314 3.78911 12.7314 4.21122 12.4711 4.47157L4.47108 12.4716C4.21073 12.7319 3.78862 12.7319 3.52827 12.4716C3.26792 12.2112 3.26792 11.7891 3.52827 11.5288L11.5283 3.52876C11.7886 3.26841 12.2107 3.26841 12.4711 3.52876Z"
      fill="#8E8E8E"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M3.52827 3.52876C3.78862 3.26841 4.21073 3.26841 4.47108 3.52876L12.4711 11.5288C12.7314 11.7891 12.7314 12.2112 12.4711 12.4716C12.2107 12.7319 11.7886 12.7319 11.5283 12.4716L3.52827 4.47157C3.26792 4.21122 3.26792 3.78911 3.52827 3.52876Z"
      fill="#8E8E8E"
    />
  </svg>
);
/**
 * Lookup table for variant and action class combinations
 */
const VARIANT_ACTION_CLASSES = {
  solid: {
    warning:
      'bg-warning text-warning-800 border-none focus-visible:outline-none',
    success:
      'bg-success text-success-800 border-none focus-visible:outline-none',
    info: 'bg-info text-info-800 border-none focus-visible:outline-none',
  },
  outlined: {
    warning:
      'bg-warning text-warning-800 border border-warning-200 focus-visible:outline-none',
    success:
      'bg-success text-success-800 border border-success-200 focus-visible:outline-none',
    info: 'bg-info text-info-800 border border-info-200 focus-visible:outline-none',
  },
} as const;

type ToastPosition =
  | 'top-left'
  | 'top-center'
  | 'top-right'
  | 'bottom-left'
  | 'bottom-center'
  | 'bottom-right'
  | 'default';

type ToastProps = {
  title: string;
  description?: string;
  onClose: () => void;
  /** Visual variant of the badge */
  variant?: 'solid' | 'outlined';
  /** Action type of the badge  */
  action?: 'warning' | 'success' | 'info';
  position?: ToastPosition;
} & React.HTMLAttributes<HTMLDivElement>;

export const Toast = ({
  variant = 'outlined',
  action = 'success',
  className = '',
  onClose,
  title,
  description,
  position = 'default',
  ...props
}: ToastProps) => {
  // Get classes from lookup tables
  const variantActionMap = VARIANT_ACTION_CLASSES[variant] || {};
  const variantClasses =
    typeof variantActionMap === 'string'
      ? variantActionMap
      : ((variantActionMap as Record<string, string>)[action] ??
        (variantActionMap as Record<string, string>).muted ??
        '');

  const positionClasses: Record<ToastPosition, string> = {
    'top-left': 'fixed top-4 left-4',
    'top-center': 'fixed top-4 left-1/2 transform -translate-x-1/2',
    'top-right': 'fixed top-4 right-4',
    'bottom-left': 'fixed bottom-4 left-4',
    'bottom-center': 'fixed bottom-4 left-1/2 transform -translate-x-1/2',
    'bottom-right': 'fixed bottom-4 right-4',
    default: '',
  };

  const IconAction =
    action == 'success'
      ? IconSuccess
      : action == 'info'
        ? IconInfo
        : action == 'warning'
          ? IconWarning
          : IconSuccess;
  // fixed bottom-4 right-4
  const baseClasses =
    'max-w-[390px] w-full flex flex-row items-start justify-between shadow-lg rounded-lg border p-4 gap-6 group';

  return (
    <div
      role="alert"
      aria-live="assertive"
      aria-atomic="true"
      className={`${baseClasses} ${positionClasses[position]} ${variantClasses} ${className}`}
      {...props}
    >
      <div className="flex flex-row items-start gap-3">
        <span className="mt-1">
          <IconAction />
        </span>
        <div className="flex flex-col items-start justify-start">
          <p className="font-semibold text-md">{title}</p>
          {description && (
            <p className="text-md text-text-900">{description}</p>
          )}
        </div>
      </div>
      <button
        onClick={onClose}
        className=" text-background-500 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacit"
      >
        <IconClose />
      </button>
    </div>
  );
};
